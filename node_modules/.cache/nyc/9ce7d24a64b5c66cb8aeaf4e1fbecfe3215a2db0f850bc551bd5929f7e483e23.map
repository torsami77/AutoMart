{"version":3,"sources":["signUp.js"],"names":["app","use","bodyParser","json","urlencoded","extended","text","type","signUp","req","res","body","username","firstName","lastName","address","checker","i","forEach","item","replace","toLowerCase","email","password","verify","mailformat","status","send","error","success","field","match","length","db","users","map","user","bcrypt","hash","newUser","id","first_name","last_name","is_admin","created_on","Date","push","data","message"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA,IAAMA,GAAG,GAAG,0BAAZ;AAEAA,GAAG,CAACC,GAAJ,CAAQC,uBAAWC,IAAX,EAAR;AACAH,GAAG,CAACC,GAAJ,CAAQC,uBAAWE,UAAX,CAAsB;AAAEC,EAAAA,QAAQ,EAAE;AAAZ,CAAtB,CAAR;AACAL,GAAG,CAACC,GAAJ,CAAQC,uBAAWI,IAAX,EAAR;AACAN,GAAG,CAACC,GAAJ,CAAQC,uBAAWC,IAAX,CAAgB;AAAEI,EAAAA,IAAI,EAAE;AAAR,CAAhB,CAAR;;AAGA,IAAMC,MAAM,GAAG,SAATA,MAAS,CAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,kBAGvBD,GAAG,CAACE,IAHmB;AAAA,MAEzBC,QAFyB,aAEzBA,QAFyB;AAAA,MAEfC,SAFe,aAEfA,SAFe;AAAA,MAEJC,QAFI,aAEJA,QAFI;AAAA,MAEMC,OAFN,aAEMA,OAFN;AAI3B,MAAIC,OAAO,GAAG,CAACJ,QAAD,EAAWC,SAAX,EAAsBC,QAAtB,EAAgCC,OAAhC,CAAd;AAEA,MAAIE,CAAC,GAAG,CAAR;AACAD,EAAAA,OAAO,CAACE,OAAR,CAAgB,UAACC,IAAD,EAAU;AACxB,QAAIA,IAAI,KAAK,EAAb,EAAiB;AACfH,MAAAA,OAAO,CAACC,CAAD,CAAP,GAAaE,IAAI,CAACC,OAAL,CAAa,gBAAb,EAA+B,EAA/B,EAAmCC,WAAnC,EAAb;AACAJ,MAAAA,CAAC,IAAI,CAAL;AACD;AACF,GALD;AAOCL,EAAAA,QAd0B,GAcgBI,OAdhB;AAchBH,EAAAA,SAdgB,GAcgBG,OAdhB;AAcLF,EAAAA,QAdK,GAcgBE,OAdhB;AAcKD,EAAAA,OAdL,GAcgBC,OAdhB;AAAA,mBAmBvBP,GAAG,CAACE,IAnBmB;AAAA,MAkBzBW,KAlByB,cAkBzBA,KAlByB;AAAA,MAkBlBC,QAlBkB,cAkBlBA,QAlBkB;AAAA,MAkBRC,MAlBQ,cAkBRA,MAlBQ;AAqB3B,MAAMC,UAAU,GAAG,6CAAnB;;AAEA,MAAIb,QAAQ,KAAK,EAAjB,EAAqB;AACnB,WAAOF,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,KAAK,EAAE,2BAFmB;AAG1BC,MAAAA,OAAO,EAAE,OAHiB;AAI1BC,MAAAA,KAAK,EAAE;AAJmB,KAArB,CAAP;AAMD;;AAED,MAAI,CAACR,KAAK,CAACS,KAAN,CAAYN,UAAZ,CAAL,EAA8B;AAC5B,WAAOf,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,KAAK,EAAE,4BAFmB;AAG1BC,MAAAA,OAAO,EAAE,OAHiB;AAI1BC,MAAAA,KAAK,EAAE;AAJmB,KAArB,CAAP;AAMD;;AAED,MAAIjB,SAAS,KAAK,EAAlB,EAAsB;AACpB,WAAOH,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,KAAK,EAAE,8BAFmB;AAG1BC,MAAAA,OAAO,EAAE,OAHiB;AAI1BC,MAAAA,KAAK,EAAE;AAJmB,KAArB,CAAP;AAMD;;AAGD,MAAIhB,QAAQ,KAAK,EAAjB,EAAqB;AACnB,WAAOJ,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,KAAK,EAAE,6BAFmB;AAG1BC,MAAAA,OAAO,EAAE,OAHiB;AAI1BC,MAAAA,KAAK,EAAE;AAJmB,KAArB,CAAP;AAMD;;AAED,MAAIf,OAAO,KAAK,EAAhB,EAAoB;AAClB,WAAOL,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,KAAK,EAAE,2BAFmB;AAG1BC,MAAAA,OAAO,EAAE,OAHiB;AAI1BC,MAAAA,KAAK,EAAE;AAJmB,KAArB,CAAP;AAMD;;AAED,MAAIP,QAAQ,KAAK,EAAjB,EAAqB;AACnB,WAAOb,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,KAAK,EAAE,2BAFmB;AAG1BC,MAAAA,OAAO,EAAE,OAHiB;AAI1BC,MAAAA,KAAK,EAAE;AAJmB,KAArB,CAAP;AAMD;;AAED,MAAIP,QAAQ,CAACS,MAAT,GAAkB,CAAtB,EAAyB;AACvB,WAAOtB,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,KAAK,EAAE,wBAFmB;AAG1BC,MAAAA,OAAO,EAAE,OAHiB;AAI1BC,MAAAA,KAAK,EAAE;AAJmB,KAArB,CAAP;AAMD;;AAED,MAAIN,MAAM,KAAKD,QAAf,EAAyB;AACvB,WAAOb,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,KAAK,EAAE,qCAFmB;AAG1BC,MAAAA,OAAO,EAAE,OAHiB;AAI1BC,MAAAA,KAAK,EAAE;AAJmB,KAArB,CAAP;AAMD;;AAEDG,iBAAGC,KAAH,CAASC,GAAT,CAAa,UAACC,IAAD,EAAU;AACrB,QAAIA,IAAI,CAACd,KAAL,KAAeA,KAAf,IAAwBc,IAAI,CAACxB,QAAL,KAAkBA,QAA9C,EAAwD;AACtD,UAAIwB,IAAI,CAACd,KAAL,KAAeA,KAAnB,EAA0B;AACxB,eAAOZ,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,UAAAA,MAAM,EAAE,GADkB;AAE1BE,UAAAA,KAAK,EAAE,wCAFmB;AAG1BC,UAAAA,OAAO,EAAE,OAHiB;AAI1BC,UAAAA,KAAK,EAAE;AAJmB,SAArB,CAAP;AAMD;;AACD,UAAIM,IAAI,CAACxB,QAAL,KAAkBA,QAAtB,EAAgC;AAC9B,eAAOF,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,UAAAA,MAAM,EAAE,GADkB;AAE1BE,UAAAA,KAAK,EAAE,yCAFmB;AAG1BC,UAAAA,OAAO,EAAE,OAHiB;AAI1BC,UAAAA,KAAK,EAAE;AAJmB,SAArB,CAAP;AAMD;AACF;;AACDO,yBAAOC,IAAP,CAAYf,QAAZ,EAAsB,EAAtB,EAA0B,UAACK,KAAD,EAAQU,IAAR,EAAiB;AACzC,UAAIV,KAAJ,EAAW;AACT,eAAOlB,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,UAAAA,MAAM,EAAE,GADkB;AAE1BE,UAAAA,KAAK,EAALA,KAF0B;AAG1BE,UAAAA,KAAK,EAAE;AAHmB,SAArB,CAAP;AAKD;;AAED,UAAMS,OAAO,GAAG;AACdC,QAAAA,EAAE,EAAEP,eAAGC,KAAH,CAASF,MAAT,GAAkB,CADR;AAEdV,QAAAA,KAAK,EAALA,KAFc;AAGdmB,QAAAA,UAAU,EAAE5B,SAHE;AAId6B,QAAAA,SAAS,EAAE5B,QAJG;AAKdS,QAAAA,QAAQ,EAAEe,IALI;AAMdvB,QAAAA,OAAO,EAAPA,OANc;AAOd4B,QAAAA,QAAQ,EAAE,KAPI;AAQdC,QAAAA,UAAU,EAAE,IAAIC,IAAJ;AARE,OAAhB;;AAUAZ,qBAAGC,KAAH,CAASY,IAAT,CAAcP,OAAd;;AAEA,aAAO7B,GAAG,CAACiB,IAAJ,CAAS;AACdD,QAAAA,MAAM,EAAE,GADM;AAEdqB,QAAAA,IAAI,EAAE;AACJP,UAAAA,EAAE,EAAED,OAAO,CAACC,EADR;AAEJC,UAAAA,UAAU,EAAEF,OAAO,CAACE,UAFhB;AAGJC,UAAAA,SAAS,EAAEH,OAAO,CAACG,SAHf;AAIJpB,UAAAA,KAAK,EAAEiB,OAAO,CAACjB,KAJX;AAKJO,UAAAA,OAAO,EAAE,MALL;AAMJmB,UAAAA,OAAO,EAAE;AANL;AAFQ,OAAT,CAAP;AAWD,KAhCD;;AAiCA,WAAO,KAAP;AACD,GArDD;;AAsDA,SAAO,KAAP;AACD,CAvJD;;eAyJexC,M","sourceRoot":"/home/sami/Documents/AutoMart/src/ctl","sourcesContent":["import bcrypt from 'bcryptjs';\nimport express from 'express';\nimport bodyParser from 'body-parser';\nimport db from '../db/db';\n\nconst app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(bodyParser.text());\napp.use(bodyParser.json({ type: 'application/json' }));\n\n\nconst signUp = (req, res) => {\n  let {\n    username, firstName, lastName, address,\n  } = req.body;\n  let checker = [username, firstName, lastName, address];\n\n  let i = 0;\n  checker.forEach((item) => {\n    if (item !== '') {\n      checker[i] = item.replace(/[^0-9A-Za-z,]/g, '').toLowerCase();\n      i += 1;\n    }\n  });\n\n  [username, firstName, lastName, address] = checker;\n\n\n  const {\n    email, password, verify,\n  } = req.body;\n\n  const mailformat = /^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/;\n\n  if (username === '') {\n    return res.status(400).send({\n      status: 404,\n      error: 'Please Provide a Username',\n      success: 'false',\n      field: 'username',\n    });\n  }\n\n  if (!email.match(mailformat)) {\n    return res.status(400).send({\n      status: 404,\n      error: 'Please Enter a Valid Email',\n      success: 'false',\n      field: 'email',\n    });\n  }\n\n  if (firstName === '') {\n    return res.status(400).send({\n      status: 404,\n      error: 'Please Enter your First Name',\n      success: 'false',\n      field: 'first-name',\n    });\n  }\n\n\n  if (lastName === '') {\n    return res.status(400).send({\n      status: 404,\n      error: 'Please Enter your Last Name',\n      success: 'false',\n      field: 'last-name',\n    });\n  }\n\n  if (address === '') {\n    return res.status(400).send({\n      status: 404,\n      error: 'Please Enter your Address',\n      success: 'false',\n      field: 'username',\n    });\n  }\n\n  if (password === '') {\n    return res.status(400).send({\n      status: 404,\n      error: 'Please Provide a Password',\n      success: 'false',\n      field: 'password',\n    });\n  }\n\n  if (password.length < 8) {\n    return res.status(400).send({\n      status: 404,\n      error: 'Password is Too Short!',\n      success: 'false',\n      field: 'password',\n    });\n  }\n\n  if (verify !== password) {\n    return res.status(400).send({\n      status: 404,\n      error: 'Verifiable Password Does not Match!',\n      success: 'false',\n      field: 'password',\n    });\n  }\n\n  db.users.map((user) => {\n    if (user.email === email || user.username === username) {\n      if (user.email === email) {\n        return res.status(400).send({\n          status: 404,\n          error: 'Email is associated with another user!',\n          success: 'false',\n          field: 'email',\n        });\n      }\n      if (user.username === username) {\n        return res.status(400).send({\n          status: 404,\n          error: 'Username already taken by another user!',\n          success: 'false',\n          field: 'username',\n        });\n      }\n    }\n    bcrypt.hash(password, 10, (error, hash) => {\n      if (error) {\n        return res.status(400).send({\n          status: 404,\n          error,\n          field: 'password',\n        });\n      }\n\n      const newUser = {\n        id: db.users.length + 1,\n        email,\n        first_name: firstName,\n        last_name: lastName,\n        password: hash,\n        address,\n        is_admin: false,\n        created_on: new Date(),\n      };\n      db.users.push(newUser);\n\n      return res.send({\n        status: 200,\n        data: {\n          id: newUser.id,\n          first_name: newUser.first_name,\n          last_name: newUser.last_name,\n          email: newUser.email,\n          success: 'true',\n          message: 'Your Signed up was successful',\n        },\n      });\n    });\n    return false;\n  });\n  return false;\n};\n\nexport default signUp;\n"]}