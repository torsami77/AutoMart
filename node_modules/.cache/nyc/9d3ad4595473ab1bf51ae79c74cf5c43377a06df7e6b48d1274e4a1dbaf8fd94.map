{"version":3,"sources":["verifyToken.js"],"names":["app","dotenv","config","use","bodyParser","json","urlencoded","extended","text","type","verifyToken","req","res","next","authorization","headers","decoded","jwt","verify","process","env","SECRET_KEY","userData","error","cookie","status","send","success"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA,IAAMA,GAAG,GAAG,0BAAZ;;AACAC,mBAAOC,MAAP;;AAEAF,GAAG,CAACG,GAAJ,CAAQC,uBAAWC,IAAX,EAAR;AACAL,GAAG,CAACG,GAAJ,CAAQC,uBAAWE,UAAX,CAAsB;AAAEC,EAAAA,QAAQ,EAAE;AAAZ,CAAtB,CAAR;AACAP,GAAG,CAACG,GAAJ,CAAQC,uBAAWI,IAAX,EAAR;AACAR,GAAG,CAACG,GAAJ,CAAQC,uBAAWC,IAAX,CAAgB;AAAEI,EAAAA,IAAI,EAAE;AAAR,CAAhB,CAAR;;AAGA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAAA,MAC9BC,aAD8B,GACZH,GAAG,CAACI,OADQ,CAC9BD,aAD8B;;AAEtC,MAAI;AACF,QAAME,OAAO,GAAGC,yBAAIC,MAAJ,CAAWJ,aAAX,EAA0BK,OAAO,CAACC,GAAR,CAAYC,UAAtC,CAAhB;;AACAV,IAAAA,GAAG,CAACW,QAAJ,GAAeN,OAAf;AACAH,IAAAA,IAAI;AACL,GAJD,CAIE,OAAOU,KAAP,EAAc;AACdX,IAAAA,GAAG,CAACY,MAAJ,CAAW,UAAX,EAAuB,IAAvB;AACAZ,IAAAA,GAAG,CAACY,MAAJ,CAAW,OAAX,EAAoB,IAApB;AACA,WAAOZ,GAAG,CAACa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BF,MAAAA,KAAK,EAAE,oBAFmB;AAG1BI,MAAAA,OAAO,EAAE;AAHiB,KAArB,CAAP;AAKD;;AACD,SAAO,KAAP;AACD,CAhBD;;eAmBejB,W","sourceRoot":"/home/sami/Documents/AutoMart/src/mid","sourcesContent":["import express from 'express';\nimport dotenv from 'dotenv';\nimport bodyParser from 'body-parser';\nimport jwt from 'jsonwebtoken';\n\nconst app = express();\ndotenv.config();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(bodyParser.text());\napp.use(bodyParser.json({ type: 'application/json' }));\n\n\nconst verifyToken = (req, res, next) => {\n  const { authorization } = req.headers;\n  try {\n    const decoded = jwt.verify(authorization, process.env.SECRET_KEY);\n    req.userData = decoded;\n    next();\n  } catch (error) {\n    res.cookie('userData', null);\n    res.cookie('token', null);\n    return res.status(403).send({\n      status: 403,\n      error: 'Unauthorised User!',\n      success: 'false',\n    });\n  }\n  return false;\n};\n\n\nexport default verifyToken;\n"]}