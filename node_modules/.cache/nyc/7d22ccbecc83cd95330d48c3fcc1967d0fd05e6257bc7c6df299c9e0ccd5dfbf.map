{"version":3,"sources":["viewer.js"],"names":["app","use","bodyParser","json","urlencoded","extended","text","type","Viewer","req","res","params","carId","isNaN","parseInt","status","send","error","success","field","db","cars","map","car","console","log","id","data","query","state","minPrice","maxPrice","manufacturer","model","bodyType","searchObjects","searchTerm","searchFields","forEach","item","undefined","push","arrOfSearch","Object","keys","keyItem","price","includes","length"],"mappings":"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","sourceRoot":"/home/sami/Documents/AutoMart/src/ctl","sourcesContent":["import express from 'express';\nimport bodyParser from 'body-parser';\nimport db from '../db/db';\n\nconst app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(bodyParser.text());\napp.use(bodyParser.json({ type: 'application/json' }));\n\n\nclass Viewer {\n  static specificCar(req, res) {\n    if (!req.params.carId || isNaN(parseInt(req.params.carId, 10))) {\n      res.status(401).send({\n        status: 401,\n        error: 'Please provide a valid Ad reference!',\n        success: 'false',\n        field: 'car',\n      });\n      return false;\n    }\n    db.cars.map((car) => {\n      console.log(car)\n      if (car.id === req.params.carId) {\n        res.status(200).send({\n          status: 200,\n          data: car,\n          success: 'true',\n          field: 'car',\n        });\n        return false;\n      }\n      res.status(404).send({\n        status: 404,\n        error: 'Ad not found!',\n        success: 'false',\n        field: 'car',\n      });\n      return false;\n    });\n    return false;\n  }\n\n  static dynamicView(req, res) {\n    // eslint-disable-next-line object-curly-newline\n    let { status, state, minPrice, maxPrice, manufacturer, model, bodyType } = req.query;\n    //let { minPrice } = req.query;\n    // eslint-disable-next-line object-curly-newline\n    const searchObjects = { state, minPrice, maxPrice, manufacturer, model, bodyType };\n    const searchTerm = [state, minPrice, maxPrice, manufacturer, model, bodyType];\n    const searchFields = [];\n    searchTerm.forEach((item) => {\n      if (undefined !== item) {\n        searchFields.push(item);\n      }\n    });\n    const arrOfSearch = [];\n\n    if (status === 'available') {\n      if (undefined === minPrice) {\n        minPrice = 0;\n      }\n      if (maxPrice) {\n        db.cars.map((car) => {\n          Object.keys(searchObjects).forEach((keyItem) => {\n            if ((keyItem !== 'minPrice' || keyItem !== 'maxPrice') && car.price >= minPrice && car.price <= maxPrice && undefined !== car[keyItem] && car.status === 'available' && car[keyItem] === searchObjects[keyItem] && (!arrOfSearch.includes(car))) {\n              arrOfSearch.push(car);\n            }\n          });\n          return false;\n        });\n        if (undefined === arrOfSearch || arrOfSearch.length === 0) {\n          return res.status(404).send({\n            status: 404,\n            error: 'Your Search wasn\\'t not found',\n            success: 'false',\n            field: searchFields,\n          });\n        }\n        if (undefined !== arrOfSearch && arrOfSearch.length !== 0) {\n          return res.status(200).send({\n            status: 200,\n            success: 'true',\n            data: arrOfSearch,\n          });\n        }\n      }\n\n      db.cars.map((car) => {\n        Object.keys(searchObjects).forEach((keyItem) => {\n          if (undefined !== car[keyItem] && car.status === 'available' && car[keyItem] === searchObjects[keyItem] && (!arrOfSearch.includes(car))) {\n            arrOfSearch.push(car);\n          }\n        });\n        return false;\n      });\n      if (undefined === arrOfSearch || arrOfSearch.length === 0) {\n        return res.status(404).send({\n          status: 404,\n          error: 'Your Search wasn\\'t not found',\n          success: 'false',\n          field: searchFields,\n        });\n      }\n      if (undefined !== arrOfSearch && arrOfSearch.length !== 0) {\n        return res.status(200).send({\n          status: 200,\n          success: 'true',\n          data: arrOfSearch,\n        });\n      }\n\n      // if previous search conditions weren't thought, search returns all available Ad\n      db.cars.map((car) => {\n        if (car.status === 'available') {\n          arrOfSearch.push(car);\n        }\n        return false;\n      });\n      if (undefined === arrOfSearch || arrOfSearch.length === 0) {\n        return res.status(404).send({\n          status: 404,\n          error: 'Your Search wasn\\'t not found',\n          success: 'false',\n          field: searchFields,\n        });\n      }\n      return res.status(200).send({\n        status: 200,\n        success: 'true',\n        data: arrOfSearch,\n      });\n    }\n    // If status=available not specified, search falls back to admin's view all (sold and available)\n    // admin.viewAll(req, res);\n    return res.status(403).send({\n      status: 403,\n      error: 'You are not Admin',\n    });\n  }\n}\n\nexport default Viewer;\n"]}