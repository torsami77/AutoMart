{"version":3,"sources":["admin.js"],"names":["app","use","bodyParser","json","urlencoded","extended","text","type","employJwt","req","res","authorization","headers","decoded","jwt","verify","process","env","SECRET_KEY","userData","error","status","send","success","Admin","checkAdmin","db","users","map","user","id","is_admin","data","cars","params","carId","isNaN","parseInt","field","deleteAd","counter","car","splice","message"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;;;;;AAGA,IAAMA,GAAG,GAAG,0BAAZ;AAEAA,GAAG,CAACC,GAAJ,CAAQC,uBAAWC,IAAX,EAAR;AACAH,GAAG,CAACC,GAAJ,CAAQC,uBAAWE,UAAX,CAAsB;AAAEC,EAAAA,QAAQ,EAAE;AAAZ,CAAtB,CAAR;AACAL,GAAG,CAACC,GAAJ,CAAQC,uBAAWI,IAAX,EAAR;AACAN,GAAG,CAACC,GAAJ,CAAQC,uBAAWC,IAAX,CAAgB;AAAEI,EAAAA,IAAI,EAAE;AAAR,CAAhB,CAAR;;AAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,MACtBC,aADsB,GACJF,GAAG,CAACG,OADA,CACtBD,aADsB;;AAE9B,MAAI;AACF,QAAME,OAAO,GAAGC,yBAAIC,MAAJ,CAAWJ,aAAX,EAA0BK,OAAO,CAACC,GAAR,CAAYC,UAAtC,CAAhB;;AACAT,IAAAA,GAAG,CAACU,QAAJ,GAAeN,OAAf;AACD,GAHD,CAGE,OAAOO,KAAP,EAAc;AACd,WAAOV,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BD,MAAAA,KAAK,EAAE,oBAFmB;AAG1BG,MAAAA,OAAO,EAAE;AAHiB,KAArB,CAAP;AAKD;;AACD,SAAO,KAAP;AACD,CAbD;;IAgBMC,K;;;;;;;;;4BACWf,G,EAAKC,G,EAAK;AACvBF,MAAAA,SAAS,CAACC,GAAD,EAAMC,GAAN,CAAT;AACA,UAAIe,UAAU,GAAG,CAAjB;;AACAC,qBAAGC,KAAH,CAASC,GAAT,CAAa,UAACC,IAAD,EAAU;AACrB,YAAIA,IAAI,CAACC,EAAL,KAAYrB,GAAG,CAACU,QAAJ,CAAaW,EAAzB,IAA+BD,IAAI,CAACE,QAAL,KAAkB,IAArD,EAA2D;AACzDN,UAAAA,UAAU,GAAG,CAAb;AACD;;AACD,eAAO,KAAP;AACD,OALD;;AAMA,UAAIA,UAAU,KAAK,CAAnB,EAAsB;AACpB,eAAOf,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,UAAAA,MAAM,EAAE,GADkB;AAE1BW,UAAAA,IAAI,EAAEN,eAAGO,IAFiB;AAG1BV,UAAAA,OAAO,EAAE;AAHiB,SAArB,CAAP,CADoB,CAMtB;AACC,OAPD,MAOO;AACL,eAAOb,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,UAAAA,MAAM,EAAE,GADkB;AAE1BD,UAAAA,KAAK,EAAE,sDAFmB;AAG1BG,UAAAA,OAAO,EAAE;AAHiB,SAArB,CAAP;AAKD;AACF;;;4BAEad,G,EAAKC,G,EAAK;AACtBF,MAAAA,SAAS,CAACC,GAAD,EAAMC,GAAN,CAAT;;AACA,UAAI,CAACD,GAAG,CAACyB,MAAJ,CAAWC,KAAZ,IAAqBC,KAAK,CAACC,QAAQ,CAAC5B,GAAG,CAACyB,MAAJ,CAAWC,KAAZ,EAAmB,EAAnB,CAAT,CAA9B,EAAgE;AAC9D,eAAOzB,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,UAAAA,MAAM,EAAE,GADkB;AAE1BD,UAAAA,KAAK,EAAE,sCAFmB;AAG1BG,UAAAA,OAAO,EAAE,OAHiB;AAI1Be,UAAAA,KAAK,EAAE;AAJmB,SAArB,CAAP;AAMD;;AAED,UAAIC,QAAQ,GAAG,CAAf;AACA,UAAIC,OAAO,GAAG,CAAd;;AACAd,qBAAGC,KAAH,CAASC,GAAT,CAAa,UAACC,IAAD,EAAU;AACrBU,QAAAA,QAAQ,GAAG,CAAX;;AACA,YAAIV,IAAI,CAACC,EAAL,KAAYrB,GAAG,CAACU,QAAJ,CAAaW,EAAzB,IAA+BD,IAAI,CAACE,QAAL,KAAkB,IAArD,EAA2D;AACzDL,yBAAGO,IAAH,CAAQL,GAAR,CAAY,UAACa,GAAD,EAAS;AACnB,gBAAIA,GAAG,CAACX,EAAJ,KAAWO,QAAQ,CAAC5B,GAAG,CAACyB,MAAJ,CAAWC,KAAZ,EAAmB,EAAnB,CAAvB,EAA+C;AAC7CT,6BAAGO,IAAH,CAAQS,MAAR,CAAeF,OAAf,EAAwB,CAAxB;;AACAD,cAAAA,QAAQ,GAAG,CAAX;AACD;;AACDC,YAAAA,OAAO,IAAI,CAAX;AACA,mBAAO,KAAP;AACD,WAPD;AAQD;;AACD,eAAO,KAAP;AACD,OAbD;;AAcA,UAAID,QAAQ,KAAK,CAAjB,EAAoB;AAClB,eAAO7B,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,UAAAA,MAAM,EAAE,GADkB;AAE1BW,UAAAA,IAAI,EAAE;AACJW,YAAAA,OAAO,EAAE,8BADL;AAEJpB,YAAAA,OAAO,EAAE;AAFL;AAFoB,SAArB,CAAP;AAOD;;AACD,UAAIgB,QAAQ,KAAK,CAAjB,EAAoB;AAClB,eAAO7B,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,UAAAA,MAAM,EAAE,GADkB;AAE1BD,UAAAA,KAAK,EAAE,eAFmB;AAG1BG,UAAAA,OAAO,EAAE;AAHiB,SAArB,CAAP,CADkB,CAMpB;AACC,OAPD,MAOO;AACL,eAAOb,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,UAAAA,MAAM,EAAE,GADkB;AAE1BD,UAAAA,KAAK,EAAE,8CAFmB;AAG1BG,UAAAA,OAAO,EAAE;AAHiB,SAArB,CAAP;AAKD;AACF;;;;;;eAGYC,K","sourceRoot":"/home/sami/Documents/AutoMart/src/ctl","sourcesContent":["import express from 'express';\nimport bodyParser from 'body-parser';\nimport jwt from 'jsonwebtoken';\nimport db from '../db/db';\n\n\nconst app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(bodyParser.text());\napp.use(bodyParser.json({ type: 'application/json' }));\n\nconst employJwt = (req, res) => {\n  const { authorization } = req.headers;\n  try {\n    const decoded = jwt.verify(authorization, process.env.SECRET_KEY);\n    req.userData = decoded;\n  } catch (error) {\n    return res.status(403).send({\n      status: 403,\n      error: 'Unauthorised User!',\n      success: 'false',\n    });\n  }\n  return false;\n};\n\n\nclass Admin {\n  static viewAll(req, res) {\n    employJwt(req, res);\n    let checkAdmin = 0;\n    db.users.map((user) => {\n      if (user.id === req.userData.id && user.is_admin === true) {\n        checkAdmin = 1;\n      }\n      return false;\n    });\n    if (checkAdmin === 1) {\n      return res.status(200).send({\n        status: 200,\n        data: db.cars,\n        success: 'true',\n      });\n    // eslint-disable-next-line no-else-return\n    } else {\n      return res.status(403).send({\n        status: 403,\n        error: 'You need Admin priviledges to view this set of data!',\n        success: 'false',\n      });\n    }\n  }\n\n  static delete(req, res) {\n    employJwt(req, res);\n    if (!req.params.carId || isNaN(parseInt(req.params.carId, 10))) {\n      return res.status(401).send({\n        status: 401,\n        error: 'Please provide a valid Ad reference!',\n        success: 'false',\n        field: 'order',\n      });\n    }\n\n    let deleteAd = 0;\n    let counter = 0;\n    db.users.map((user) => {\n      deleteAd = 1;\n      if (user.id === req.userData.id && user.is_admin === true) {\n        db.cars.map((car) => {\n          if (car.id === parseInt(req.params.carId, 10)) {\n            db.cars.splice(counter, 1);\n            deleteAd = 2;\n          }\n          counter += 1;\n          return false;\n        });\n      }\n      return false;\n    });\n    if (deleteAd === 2) {\n      return res.status(200).send({\n        status: 200,\n        data: {\n          message: 'Car Ad successfully deleted!',\n          success: 'true',\n        },\n      });\n    }\n    if (deleteAd === 1) {\n      return res.status(404).send({\n        status: 404,\n        error: 'Ad not found!',\n        success: 'false',\n      });\n    // eslint-disable-next-line no-else-return\n    } else {\n      return res.status(403).send({\n        status: 403,\n        error: 'You need Admin priviledges to delete this Ad',\n        success: 'false',\n      });\n    }\n  }\n}\n\nexport default Admin;\n"]}