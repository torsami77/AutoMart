"use strict";var cov_byk0av6zl=function(){var path="/home/sami/Documents/AutoMart/src/ctl/admin.js";var hash="b493832a33d52e5ca1303db47df7e75d0e0e1db4";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/sami/Documents/AutoMart/src/ctl/admin.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:28}},"2":{start:{line:8,column:15},end:{line:8,column:57}},"3":{start:{line:10,column:18},end:{line:10,column:64}},"4":{start:{line:12,column:20},end:{line:12,column:67}},"5":{start:{line:14,column:10},end:{line:14,column:53}},"6":{start:{line:16,column:39},end:{line:16,column:95}},"7":{start:{line:18,column:50},end:{line:18,column:151}},"8":{start:{line:18,column:92},end:{line:18,column:149}},"9":{start:{line:20,column:44},end:{line:20,column:315}},"10":{start:{line:20,column:57},end:{line:20,column:58}},"11":{start:{line:20,column:102},end:{line:20,column:110}},"12":{start:{line:20,column:112},end:{line:20,column:167}},"13":{start:{line:20,column:168},end:{line:20,column:199}},"14":{start:{line:20,column:200},end:{line:20,column:254}},"15":{start:{line:20,column:227},end:{line:20,column:254}},"16":{start:{line:20,column:255},end:{line:20,column:313}},"17":{start:{line:22,column:62},end:{line:22,column:131}},"18":{start:{line:22,column:78},end:{line:22,column:131}},"19":{start:{line:22,column:132},end:{line:22,column:193}},"20":{start:{line:22,column:149},end:{line:22,column:193}},"21":{start:{line:22,column:194},end:{line:22,column:213}},"22":{start:{line:24,column:10},end:{line:24,column:36}},"23":{start:{line:25,column:0},end:{line:25,column:39}},"24":{start:{line:26,column:0},end:{line:28,column:4}},"25":{start:{line:29,column:0},end:{line:29,column:39}},"26":{start:{line:30,column:0},end:{line:32,column:4}},"27":{start:{line:34,column:16},end:{line:50,column:1}},"28":{start:{line:35,column:22},end:{line:35,column:47}},"29":{start:{line:37,column:2},end:{line:47,column:3}},"30":{start:{line:38,column:18},end:{line:38,column:88}},"31":{start:{line:40,column:4},end:{line:40,column:27}},"32":{start:{line:42,column:4},end:{line:46,column:7}},"33":{start:{line:49,column:2},end:{line:49,column:15}},"34":{start:{line:54,column:0},end:{line:184,column:3}},"35":{start:{line:56,column:4},end:{line:56,column:33}},"36":{start:{line:59,column:2},end:{line:181,column:6}},"37":{start:{line:62,column:6},end:{line:62,column:26}},"38":{start:{line:63,column:23},end:{line:63,column:24}},"39":{start:{line:65,column:6},end:{line:71,column:9}},"40":{start:{line:66,column:8},end:{line:68,column:9}},"41":{start:{line:67,column:10},end:{line:67,column:25}},"42":{start:{line:70,column:8},end:{line:70,column:21}},"43":{start:{line:73,column:6},end:{line:85,column:7}},"44":{start:{line:74,column:8},end:{line:78,column:11}},"45":{start:{line:80,column:8},end:{line:84,column:11}},"46":{start:{line:90,column:6},end:{line:90,column:26}},"47":{start:{line:92,column:6},end:{line:99,column:7}},"48":{start:{line:93,column:8},end:{line:98,column:11}},"49":{start:{line:120,column:20},end:{line:122,column:8}},"50":{start:{line:121,column:8},end:{line:121,column:69}},"51":{start:{line:124,column:6},end:{line:152,column:7}},"52":{start:{line:125,column:25},end:{line:127,column:10}},"53":{start:{line:126,column:10},end:{line:126,column:59}},"54":{start:{line:129,column:8},end:{line:145,column:9}},"55":{start:{line:130,column:10},end:{line:130,column:49}},"56":{start:{line:132,column:10},end:{line:138,column:13}},"57":{start:{line:140,column:10},end:{line:144,column:13}},"58":{start:{line:147,column:8},end:{line:151,column:11}},"59":{start:{line:183,column:2},end:{line:183,column:15}},"60":{start:{line:186,column:15},end:{line:186,column:20}},"61":{start:{line:187,column:0},end:{line:187,column:30}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:16,column:9},end:{line:16,column:31}},loc:{start:{line:16,column:37},end:{line:16,column:97}},line:16},"1":{name:"_classCallCheck",decl:{start:{line:18,column:9},end:{line:18,column:24}},loc:{start:{line:18,column:48},end:{line:18,column:153}},line:18},"2":{name:"_defineProperties",decl:{start:{line:20,column:9},end:{line:20,column:26}},loc:{start:{line:20,column:42},end:{line:20,column:317}},line:20},"3":{name:"_createClass",decl:{start:{line:22,column:9},end:{line:22,column:21}},loc:{start:{line:22,column:60},end:{line:22,column:215}},line:22},"4":{name:"employJwt",decl:{start:{line:34,column:25},end:{line:34,column:34}},loc:{start:{line:34,column:45},end:{line:50,column:1}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:54,column:0},end:{line:54,column:1}},loc:{start:{line:54,column:12},end:{line:184,column:1}},line:54},"6":{name:"Admin",decl:{start:{line:55,column:11},end:{line:55,column:16}},loc:{start:{line:55,column:19},end:{line:57,column:3}},line:55},"7":{name:"viewAll",decl:{start:{line:61,column:20},end:{line:61,column:27}},loc:{start:{line:61,column:38},end:{line:86,column:5}},line:61},"8":{name:"(anonymous_8)",decl:{start:{line:65,column:31},end:{line:65,column:32}},loc:{start:{line:65,column:47},end:{line:71,column:7}},line:65},"9":{name:"_delete",decl:{start:{line:89,column:20},end:{line:89,column:27}},loc:{start:{line:89,column:38},end:{line:153,column:5}},line:89},"10":{name:"(anonymous_10)",decl:{start:{line:120,column:46},end:{line:120,column:47}},loc:{start:{line:120,column:62},end:{line:122,column:7}},line:120},"11":{name:"(anonymous_11)",decl:{start:{line:125,column:50},end:{line:125,column:51}},loc:{start:{line:125,column:65},end:{line:127,column:9}},line:125}},branchMap:{"0":{loc:{start:{line:16,column:46},end:{line:16,column:94}},type:"cond-expr",locations:[{start:{line:16,column:70},end:{line:16,column:73}},{start:{line:16,column:76},end:{line:16,column:94}}],line:16},"1":{loc:{start:{line:16,column:46},end:{line:16,column:67}},type:"binary-expr",locations:[{start:{line:16,column:46},end:{line:16,column:49}},{start:{line:16,column:53},end:{line:16,column:67}}],line:16},"2":{loc:{start:{line:18,column:50},end:{line:18,column:151}},type:"if",locations:[{start:{line:18,column:50},end:{line:18,column:151}},{start:{line:18,column:50},end:{line:18,column:151}}],line:18},"3":{loc:{start:{line:20,column:136},end:{line:20,column:166}},type:"binary-expr",locations:[{start:{line:20,column:136},end:{line:20,column:157}},{start:{line:20,column:161},end:{line:20,column:166}}],line:20},"4":{loc:{start:{line:20,column:200},end:{line:20,column:254}},type:"if",locations:[{start:{line:20,column:200},end:{line:20,column:254}},{start:{line:20,column:200},end:{line:20,column:254}}],line:20},"5":{loc:{start:{line:22,column:62},end:{line:22,column:131}},type:"if",locations:[{start:{line:22,column:62},end:{line:22,column:131}},{start:{line:22,column:62},end:{line:22,column:131}}],line:22},"6":{loc:{start:{line:22,column:132},end:{line:22,column:193}},type:"if",locations:[{start:{line:22,column:132},end:{line:22,column:193}},{start:{line:22,column:132},end:{line:22,column:193}}],line:22},"7":{loc:{start:{line:66,column:8},end:{line:68,column:9}},type:"if",locations:[{start:{line:66,column:8},end:{line:68,column:9}},{start:{line:66,column:8},end:{line:68,column:9}}],line:66},"8":{loc:{start:{line:66,column:12},end:{line:66,column:65}},type:"binary-expr",locations:[{start:{line:66,column:12},end:{line:66,column:39}},{start:{line:66,column:43},end:{line:66,column:65}}],line:66},"9":{loc:{start:{line:73,column:6},end:{line:85,column:7}},type:"if",locations:[{start:{line:73,column:6},end:{line:85,column:7}},{start:{line:73,column:6},end:{line:85,column:7}}],line:73},"10":{loc:{start:{line:92,column:6},end:{line:99,column:7}},type:"if",locations:[{start:{line:92,column:6},end:{line:99,column:7}},{start:{line:92,column:6},end:{line:99,column:7}}],line:92},"11":{loc:{start:{line:92,column:10},end:{line:92,column:68}},type:"binary-expr",locations:[{start:{line:92,column:10},end:{line:92,column:27}},{start:{line:92,column:31},end:{line:92,column:68}}],line:92},"12":{loc:{start:{line:121,column:15},end:{line:121,column:68}},type:"binary-expr",locations:[{start:{line:121,column:15},end:{line:121,column:42}},{start:{line:121,column:46},end:{line:121,column:68}}],line:121},"13":{loc:{start:{line:124,column:6},end:{line:152,column:7}},type:"if",locations:[{start:{line:124,column:6},end:{line:152,column:7}},{start:{line:124,column:6},end:{line:152,column:7}}],line:124},"14":{loc:{start:{line:129,column:8},end:{line:145,column:9}},type:"if",locations:[{start:{line:129,column:8},end:{line:145,column:9}},{start:{line:129,column:8},end:{line:145,column:9}}],line:129}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"b493832a33d52e5ca1303db47df7e75d0e0e1db4"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();cov_byk0av6zl.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_byk0av6zl.s[1]++;exports["default"]=void 0;var _express=(cov_byk0av6zl.s[2]++,_interopRequireDefault(require("express")));var _bodyParser=(cov_byk0av6zl.s[3]++,_interopRequireDefault(require("body-parser")));var _jsonwebtoken=(cov_byk0av6zl.s[4]++,_interopRequireDefault(require("jsonwebtoken")));var _db=(cov_byk0av6zl.s[5]++,_interopRequireDefault(require("../db/db")));function _interopRequireDefault(obj){cov_byk0av6zl.f[0]++;cov_byk0av6zl.s[6]++;return(cov_byk0av6zl.b[1][0]++,obj)&&(cov_byk0av6zl.b[1][1]++,obj.__esModule)?(cov_byk0av6zl.b[0][0]++,obj):(cov_byk0av6zl.b[0][1]++,{"default":obj});}function _classCallCheck(instance,Constructor){cov_byk0av6zl.f[1]++;cov_byk0av6zl.s[7]++;if(!(instance instanceof Constructor)){cov_byk0av6zl.b[2][0]++;cov_byk0av6zl.s[8]++;throw new TypeError("Cannot call a class as a function");}else{cov_byk0av6zl.b[2][1]++;}}function _defineProperties(target,props){cov_byk0av6zl.f[2]++;cov_byk0av6zl.s[9]++;for(var i=(cov_byk0av6zl.s[10]++,0);i<props.length;i++){var descriptor=(cov_byk0av6zl.s[11]++,props[i]);cov_byk0av6zl.s[12]++;descriptor.enumerable=(cov_byk0av6zl.b[3][0]++,descriptor.enumerable)||(cov_byk0av6zl.b[3][1]++,false);cov_byk0av6zl.s[13]++;descriptor.configurable=true;cov_byk0av6zl.s[14]++;if("value"in descriptor){cov_byk0av6zl.b[4][0]++;cov_byk0av6zl.s[15]++;descriptor.writable=true;}else{cov_byk0av6zl.b[4][1]++;}cov_byk0av6zl.s[16]++;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){cov_byk0av6zl.f[3]++;cov_byk0av6zl.s[17]++;if(protoProps){cov_byk0av6zl.b[5][0]++;cov_byk0av6zl.s[18]++;_defineProperties(Constructor.prototype,protoProps);}else{cov_byk0av6zl.b[5][1]++;}cov_byk0av6zl.s[19]++;if(staticProps){cov_byk0av6zl.b[6][0]++;cov_byk0av6zl.s[20]++;_defineProperties(Constructor,staticProps);}else{cov_byk0av6zl.b[6][1]++;}cov_byk0av6zl.s[21]++;return Constructor;}var app=(cov_byk0av6zl.s[22]++,(0,_express["default"])());cov_byk0av6zl.s[23]++;app.use(_bodyParser["default"].json());cov_byk0av6zl.s[24]++;app.use(_bodyParser["default"].urlencoded({extended:false}));cov_byk0av6zl.s[25]++;app.use(_bodyParser["default"].text());cov_byk0av6zl.s[26]++;app.use(_bodyParser["default"].json({type:'application/json'}));cov_byk0av6zl.s[27]++;var employJwt=function employJwt(req,res){cov_byk0av6zl.f[4]++;var authorization=(cov_byk0av6zl.s[28]++,req.headers.authorization);cov_byk0av6zl.s[29]++;try{var decoded=(cov_byk0av6zl.s[30]++,_jsonwebtoken["default"].verify(authorization,process.env.SECRET_KEY));cov_byk0av6zl.s[31]++;req.userData=decoded;}catch(error){cov_byk0av6zl.s[32]++;return res.status(403).send({status:403,error:'Unauthorised User!',success:'false'});}cov_byk0av6zl.s[33]++;return false;};var Admin=(/*#__PURE__*/cov_byk0av6zl.s[34]++,function(){cov_byk0av6zl.f[5]++;function Admin(){cov_byk0av6zl.f[6]++;cov_byk0av6zl.s[35]++;_classCallCheck(this,Admin);}cov_byk0av6zl.s[36]++;_createClass(Admin,null,[{key:"viewAll",value:function viewAll(req,res){cov_byk0av6zl.f[7]++;cov_byk0av6zl.s[37]++;employJwt(req,res);var checkAdmin=(cov_byk0av6zl.s[38]++,0);cov_byk0av6zl.s[39]++;_db["default"].users.map(function(user){cov_byk0av6zl.f[8]++;cov_byk0av6zl.s[40]++;if((cov_byk0av6zl.b[8][0]++,user.id===req.userData.id)&&(cov_byk0av6zl.b[8][1]++,user.is_admin===true)){cov_byk0av6zl.b[7][0]++;cov_byk0av6zl.s[41]++;checkAdmin=1;}else{cov_byk0av6zl.b[7][1]++;}cov_byk0av6zl.s[42]++;return false;});cov_byk0av6zl.s[43]++;if(checkAdmin===1){cov_byk0av6zl.b[9][0]++;cov_byk0av6zl.s[44]++;return res.status(200).send({status:200,data:_db["default"].cars,success:'true'});// eslint-disable-next-line no-else-return
}else{cov_byk0av6zl.b[9][1]++;cov_byk0av6zl.s[45]++;return res.status(403).send({status:403,error:'You need Admin priviledges to view this set of data!',success:'false'});}}},{key:"delete",value:function _delete(req,res){cov_byk0av6zl.f[9]++;cov_byk0av6zl.s[46]++;employJwt(req,res);cov_byk0av6zl.s[47]++;if((cov_byk0av6zl.b[11][0]++,!req.params.carId)||(cov_byk0av6zl.b[11][1]++,isNaN(parseInt(req.params.carId,10)))){cov_byk0av6zl.b[10][0]++;cov_byk0av6zl.s[48]++;return res.status(401).send({status:401,error:'Please provide a valid Ad reference!',success:'false',field:'order'});}else{cov_byk0av6zl.b[10][1]++;}/*
      let deleteAd = 0;
      let counter = 0;
      db.users.map((user) => {
        deleteAd = 1;
        if (user.id === req.userData.id && user.is_admin === true) {
          db.cars.map((car) => {
            if (car.id === parseInt(req.params.carId, 10)) {
              db.cars.splice(counter, 1);
              deleteAd = 2;
            }
            counter += 1;
            return false;
          });
        }
        return false;
      });
      */var isAdmin=(cov_byk0av6zl.s[49]++,_db["default"].users.find(function(user){cov_byk0av6zl.f[10]++;cov_byk0av6zl.s[50]++;return(cov_byk0av6zl.b[12][0]++,user.id===req.userData.id)&&(cov_byk0av6zl.b[12][1]++,user.is_admin===true);}));cov_byk0av6zl.s[51]++;if(isAdmin){cov_byk0av6zl.b[13][0]++;var searchedAd=(cov_byk0av6zl.s[52]++,_db["default"].cars.find(function(car){cov_byk0av6zl.f[11]++;cov_byk0av6zl.s[53]++;return car.id===parseInt(req.params.carId,10);}));cov_byk0av6zl.s[54]++;if(searchedAd){cov_byk0av6zl.b[14][0]++;cov_byk0av6zl.s[55]++;_db["default"].cars.splice(counter,1);cov_byk0av6zl.s[56]++;return res.status(200).send({status:200,data:{message:'Car Ad successfully deleted!',success:'true'}});}else{cov_byk0av6zl.b[14][1]++;cov_byk0av6zl.s[57]++;return res.status(404).send({status:404,error:'Ad not found!',success:'false'});}}else{cov_byk0av6zl.b[13][1]++;cov_byk0av6zl.s[58]++;return res.status(403).send({status:403,error:'You need Admin priviledges to delete this Ad',success:'false'});}}/*
      if (deleteAd === 2) {
        return res.status(200).send({
          status: 200,
          data: {
            message: 'Car Ad successfully deleted!',
            success: 'true',
          },
        });
      }
      if (deleteAd === 1) {
        return res.status(404).send({
          status: 404,
          error: 'Ad not found!',
          success: 'false',
        });
      // eslint-disable-next-line no-else-return
      } else {
        return res.status(403).send({
          status: 403,
          error: 'You need Admin priviledges to delete this Ad',
          success: 'false',
        });
      }
    }
    */}]);cov_byk0av6zl.s[59]++;return Admin;}());var _default=(cov_byk0av6zl.s[60]++,Admin);cov_byk0av6zl.s[61]++;exports["default"]=_default;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmpzIl0sIm5hbWVzIjpbImFwcCIsInVzZSIsImJvZHlQYXJzZXIiLCJqc29uIiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwidGV4dCIsInR5cGUiLCJlbXBsb3lKd3QiLCJyZXEiLCJyZXMiLCJhdXRob3JpemF0aW9uIiwiaGVhZGVycyIsImRlY29kZWQiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiU0VDUkVUX0tFWSIsInVzZXJEYXRhIiwiZXJyb3IiLCJzdGF0dXMiLCJzZW5kIiwic3VjY2VzcyIsIkFkbWluIiwiY2hlY2tBZG1pbiIsImRiIiwidXNlcnMiLCJtYXAiLCJ1c2VyIiwiaWQiLCJpc19hZG1pbiIsImRhdGEiLCJjYXJzIiwicGFyYW1zIiwiY2FySWQiLCJpc05hTiIsInBhcnNlSW50IiwiZmllbGQiLCJpc0FkbWluIiwiZmluZCIsInNlYXJjaGVkQWQiLCJjYXIiLCJzcGxpY2UiLCJjb3VudGVyIiwibWVzc2FnZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7O0FBR0EsSUFBTUEsR0FBRyxHQUFHLDBCQUFaO0FBRUFBLEdBQUcsQ0FBQ0MsR0FBSixDQUFRQyx1QkFBV0MsSUFBWCxFQUFSO0FBQ0FILEdBQUcsQ0FBQ0MsR0FBSixDQUFRQyx1QkFBV0UsVUFBWCxDQUFzQjtBQUFFQyxFQUFBQSxRQUFRLEVBQUU7QUFBWixDQUF0QixDQUFSO0FBQ0FMLEdBQUcsQ0FBQ0MsR0FBSixDQUFRQyx1QkFBV0ksSUFBWCxFQUFSO0FBQ0FOLEdBQUcsQ0FBQ0MsR0FBSixDQUFRQyx1QkFBV0MsSUFBWCxDQUFnQjtBQUFFSSxFQUFBQSxJQUFJLEVBQUU7QUFBUixDQUFoQixDQUFSOztBQUVBLElBQU1DLFNBQVMsR0FBRyxTQUFaQSxTQUFZLENBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFjO0FBQUEsTUFDdEJDLGFBRHNCLEdBQ0pGLEdBQUcsQ0FBQ0csT0FEQSxDQUN0QkQsYUFEc0I7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TUFBSixDQUFXQyxLQUFaLEVBQW1CLEVBQW5CLENBQXZCO0FBQUEsU0FBaEIsQ0FBbkI7O0FBQ0EsWUFBSU0sVUFBSixFQUFnQjtBQUNkZix5QkFBR08sSUFBSCxDQUFRVSxNQUFSLENBQWVDLE9BQWYsRUFBd0IsQ0FBeEI7O0FBQ0EsaUJBQU9sQyxHQUFHLENBQUNXLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUMxQkQsWUFBQUEsTUFBTSxFQUFFLEdBRGtCO0FBRTFCVyxZQUFBQSxJQUFJLEVBQUU7QUFDSmEsY0FBQUEsT0FBTyxFQUFFLDhCQURMO0FBRUp0QixjQUFBQSxPQUFPLEVBQUU7QUFGTDtBQUZvQixXQUFyQixDQUFQO0FBT0QsU0FURCxNQVNPO0FBQ0wsaUJBQU9iLEdBQUcsQ0FBQ1csTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQzFCRCxZQUFBQSxNQUFNLEVBQUUsR0FEa0I7QUFFMUJELFlBQUFBLEtBQUssRUFBRSxlQUZtQjtBQUcxQkcsWUFBQUEsT0FBTyxFQUFFO0FBSGlCLFdBQXJCLENBQVA7QUFLRDtBQUNGLE9BbEJELE1Ba0JPO0FBQ0wsZUFBT2IsR0FBRyxDQUFDVyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDMUJELFVBQUFBLE1BQU0sRUFBRSxHQURrQjtBQUUxQkQsVUFBQUEsS0FBSyxFQUFFLDhDQUZtQjtBQUcxQkcsVUFBQUEsT0FBTyxFQUFFO0FBSGlCLFNBQXJCLENBQVA7QUFLRDtBQUNGO0FBQ0Q7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2VBNEJhQyxLIiwic291cmNlUm9vdCI6Ii9ob21lL3NhbWkvRG9jdW1lbnRzL0F1dG9NYXJ0L3NyYy9jdGwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmltcG9ydCBib2R5UGFyc2VyIGZyb20gJ2JvZHktcGFyc2VyJztcbmltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcbmltcG9ydCBkYiBmcm9tICcuLi9kYi9kYic7XG5cblxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbigpKTtcbmFwcC51c2UoYm9keVBhcnNlci51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IGZhbHNlIH0pKTtcbmFwcC51c2UoYm9keVBhcnNlci50ZXh0KCkpO1xuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oeyB0eXBlOiAnYXBwbGljYXRpb24vanNvbicgfSkpO1xuXG5jb25zdCBlbXBsb3lKd3QgPSAocmVxLCByZXMpID0+IHtcbiAgY29uc3QgeyBhdXRob3JpemF0aW9uIH0gPSByZXEuaGVhZGVycztcbiAgdHJ5IHtcbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeShhdXRob3JpemF0aW9uLCBwcm9jZXNzLmVudi5TRUNSRVRfS0VZKTtcbiAgICByZXEudXNlckRhdGEgPSBkZWNvZGVkO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuc2VuZCh7XG4gICAgICBzdGF0dXM6IDQwMyxcbiAgICAgIGVycm9yOiAnVW5hdXRob3Jpc2VkIFVzZXIhJyxcbiAgICAgIHN1Y2Nlc3M6ICdmYWxzZScsXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuXG5jbGFzcyBBZG1pbiB7XG4gIHN0YXRpYyB2aWV3QWxsKHJlcSwgcmVzKSB7XG4gICAgZW1wbG95Snd0KHJlcSwgcmVzKTtcbiAgICBsZXQgY2hlY2tBZG1pbiA9IDA7XG4gICAgZGIudXNlcnMubWFwKCh1c2VyKSA9PiB7XG4gICAgICBpZiAodXNlci5pZCA9PT0gcmVxLnVzZXJEYXRhLmlkICYmIHVzZXIuaXNfYWRtaW4gPT09IHRydWUpIHtcbiAgICAgICAgY2hlY2tBZG1pbiA9IDE7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgaWYgKGNoZWNrQWRtaW4gPT09IDEpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBkYXRhOiBkYi5jYXJzLFxuICAgICAgICBzdWNjZXNzOiAndHJ1ZScsXG4gICAgICB9KTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZWxzZS1yZXR1cm5cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5zZW5kKHtcbiAgICAgICAgc3RhdHVzOiA0MDMsXG4gICAgICAgIGVycm9yOiAnWW91IG5lZWQgQWRtaW4gcHJpdmlsZWRnZXMgdG8gdmlldyB0aGlzIHNldCBvZiBkYXRhIScsXG4gICAgICAgIHN1Y2Nlc3M6ICdmYWxzZScsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgZGVsZXRlKHJlcSwgcmVzKSB7XG4gICAgZW1wbG95Snd0KHJlcSwgcmVzKTtcbiAgICBpZiAoIXJlcS5wYXJhbXMuY2FySWQgfHwgaXNOYU4ocGFyc2VJbnQocmVxLnBhcmFtcy5jYXJJZCwgMTApKSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKHtcbiAgICAgICAgc3RhdHVzOiA0MDEsXG4gICAgICAgIGVycm9yOiAnUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBBZCByZWZlcmVuY2UhJyxcbiAgICAgICAgc3VjY2VzczogJ2ZhbHNlJyxcbiAgICAgICAgZmllbGQ6ICdvcmRlcicsXG4gICAgICB9KTtcbiAgICB9XG4gICAgLypcbiAgICBsZXQgZGVsZXRlQWQgPSAwO1xuICAgIGxldCBjb3VudGVyID0gMDtcbiAgICBkYi51c2Vycy5tYXAoKHVzZXIpID0+IHtcbiAgICAgIGRlbGV0ZUFkID0gMTtcbiAgICAgIGlmICh1c2VyLmlkID09PSByZXEudXNlckRhdGEuaWQgJiYgdXNlci5pc19hZG1pbiA9PT0gdHJ1ZSkge1xuICAgICAgICBkYi5jYXJzLm1hcCgoY2FyKSA9PiB7XG4gICAgICAgICAgaWYgKGNhci5pZCA9PT0gcGFyc2VJbnQocmVxLnBhcmFtcy5jYXJJZCwgMTApKSB7XG4gICAgICAgICAgICBkYi5jYXJzLnNwbGljZShjb3VudGVyLCAxKTtcbiAgICAgICAgICAgIGRlbGV0ZUFkID0gMjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY291bnRlciArPSAxO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgKi9cbiAgICBjb25zdCBpc0FkbWluID0gZGIudXNlcnMuZmluZCh1c2VyID0+IHVzZXIuaWQgPT09IHJlcS51c2VyRGF0YS5pZCAmJiB1c2VyLmlzX2FkbWluID09PSB0cnVlKTtcbiAgICBpZiAoaXNBZG1pbikge1xuICAgICAgY29uc3Qgc2VhcmNoZWRBZCA9IGRiLmNhcnMuZmluZChjYXIgPT4gY2FyLmlkID09PSBwYXJzZUludChyZXEucGFyYW1zLmNhcklkLCAxMCkpO1xuICAgICAgaWYgKHNlYXJjaGVkQWQpIHtcbiAgICAgICAgZGIuY2Fycy5zcGxpY2UoY291bnRlciwgMSk7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7XG4gICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgbWVzc2FnZTogJ0NhciBBZCBzdWNjZXNzZnVsbHkgZGVsZXRlZCEnLFxuICAgICAgICAgICAgc3VjY2VzczogJ3RydWUnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKHtcbiAgICAgICAgICBzdGF0dXM6IDQwNCxcbiAgICAgICAgICBlcnJvcjogJ0FkIG5vdCBmb3VuZCEnLFxuICAgICAgICAgIHN1Y2Nlc3M6ICdmYWxzZScsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLnNlbmQoe1xuICAgICAgICBzdGF0dXM6IDQwMyxcbiAgICAgICAgZXJyb3I6ICdZb3UgbmVlZCBBZG1pbiBwcml2aWxlZGdlcyB0byBkZWxldGUgdGhpcyBBZCcsXG4gICAgICAgIHN1Y2Nlc3M6ICdmYWxzZScsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgLypcbiAgICBpZiAoZGVsZXRlQWQgPT09IDIpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgbWVzc2FnZTogJ0NhciBBZCBzdWNjZXNzZnVsbHkgZGVsZXRlZCEnLFxuICAgICAgICAgIHN1Y2Nlc3M6ICd0cnVlJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoZGVsZXRlQWQgPT09IDEpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7XG4gICAgICAgIHN0YXR1czogNDA0LFxuICAgICAgICBlcnJvcjogJ0FkIG5vdCBmb3VuZCEnLFxuICAgICAgICBzdWNjZXNzOiAnZmFsc2UnLFxuICAgICAgfSk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWVsc2UtcmV0dXJuXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuc2VuZCh7XG4gICAgICAgIHN0YXR1czogNDAzLFxuICAgICAgICBlcnJvcjogJ1lvdSBuZWVkIEFkbWluIHByaXZpbGVkZ2VzIHRvIGRlbGV0ZSB0aGlzIEFkJyxcbiAgICAgICAgc3VjY2VzczogJ2ZhbHNlJyxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICAqL1xufVxuXG5leHBvcnQgZGVmYXVsdCBBZG1pbjtcbiJdfQ==